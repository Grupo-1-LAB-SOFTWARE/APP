{
    "providers": [node],
    "buildImage": "ghcr.io/railwayapp/nixpacks:latest",
    "variables": {
      "CI": "true",
      "NIXPACKS_METADATA": "node",
      "NODE_ENV": "production",
      "NPM_CONFIG_PRODUCTION": "false"
    },
    "phases": {
      "build": {
        "dependsOn": [
          "nixpacks"
        ],
        "cmds": [
          "nixpacks build"
        ],
        "cacheDirectories": [
          "node_modules/.cache"
        ]
      },
      "install": {
        "dependsOn": [
          "setup"
        ],
        "cmds": [
          "npm install"
        ],
        "cacheDirectories": [
          "/root/.npm"
        ],
        "paths": [
          "/app/node_modules/.bin"
        ]
      },
      "setup": {
        "nixPkgs": [
          "nodejs_18",
          "npm-9_x"
        ],
        "nixLibs": [
          "libuuid",
          "libGL"
        ],
        "nixOverlays": [
          "https://github.com/railwayapp/nix-npm-overlay/archive/main.tar.gz"      
        ],
        "nixpkgsArchive": "bf744fe90419885eefced41b3e5ae442d732712d"
      }
    },
    "start": {
      "cmd": "npm start"
    }
  }
